/** layui-v2.5.5 MIT License By https://www.layui.com */
 ;layui.define(["jquery","laydate","upload"],function(e){var a=layui.$,t=layui.laydate,d=layui.upload;dataTable={cache:{},index:{},Render:{date:{},upload:{}}},WRITE_RENDERDATA=function(e,a,t,d,l){l?(dataTable.Render[a][e]||(dataTable.Render[a][e]={}),dataTable.Render[a][e][t]?(dataTable.Render[a][e][t].data.push(t+"-"+d),dataTable.Render[a][e][t].index=dataTable.Render[a][e][t].index+1):(dataTable.Render[a][e][t]={},dataTable.Render[a][e][t].data=[],dataTable.Render[a][e][t].index=0,dataTable.Render[a][e][t].data.push(t+"-"+d))):dataTable.Render[a][e][t].index=dataTable.Render[a][e][t].index+1},TEMPLATE_OBJECT=function(e){for(var a={},t=0;t<e.length;t++)e[t].edit?a[e[t].field]={edit:!0}:e[t].date?a[e[t].field]={date:!0}:e[t].upload&&(a[e[t].field]={upload:!0});return a},TABLE_HEAD=function(e){var a=["<colgroup>",function(){for(var a="",t=0;t<e.length;t++)a+=e[t].width?'<col width="'+e[t].width+'">':"<col>";return a}(),'<col width="10%"></col>',"</colgroup>","<tr>",function(){for(var a="",t=0;t<e.length;t++)a+="<th>"+e[t].title+"</th>";return a}(),"<th>操作</th>","</tr>"].join("");return a},TABLE_BODY=function(e,a,t){for(var d="",l=TEMPLATE_OBJECT(a),n=0;n<e.length;n++){d+='<tr id="'+t+"-"+n+'">';for(var r in e[n])d+=TABLE_TEMPLATE(t,l,r,n,e[n]);d+='<td><button type="button" class="layui-btn layui-btn-xs layui-btn-danger" tableId="delete" style="margin:0;">删除</button></td>',d+="</tr>",dataTable.index[t]=n}return d},TABLE_ONE=function(e,a,t){var d="",l=TEMPLATE_OBJECT(a);dataTable.index[t]=dataTable.index[t]+1,d+='<tr id="'+t+"-"+dataTable.index[t]+'">';for(var n in e[0])d+=TABLE_TEMPLATE(t,l,n,dataTable.index[t],"");return d+='<td><button type="button" class="layui-btn layui-btn-xs layui-btn-danger  tableId="delete" style="margin:0;">删除</button></td>',d+="</tr>"},TABLE_TEMPLATE=function(e,a,t,d,l){return a[t]?1==a[t].edit?'<td contentEditable="true" tableId="'+t+'">'+(l[t]?l[t]:"")+"</td>":1==a[t].date?l?(WRITE_RENDERDATA(e,"date",t,d,!0),'<td style="padding:0;" tableId="'+t+'"><input style="border:none;" type="text" class="layui-input" value="" id="'+t+"-"+d+'" autocomplete="off"></input></td>'):(WRITE_RENDERDATA(e,"date",t,d,!1),'<td style="padding:0;" tableId="'+t+'"><input style="border:none;" type="text" class="layui-input" value="" id="'+t+"-"+dataTable.Render.date[e][t].index+'" autocomplete="off"></input></td>'):1==a[t].upload?(dataTable.Render.upload[e]?(dataTable.Render.upload[e].push(t+"-"+d),dataTable.Render.upload[e+"-index"]=dataTable.Render.upload[e+"-index"]+1):(dataTable.Render.upload[e]=[t+"-"+d],dataTable.Render.upload[e+"-index"]=0),'<td  tableId="'+t+'"><button id="'+t+"-"+dataTable.Render.upload[e+"-index"]+'" class="layui-btn layui-btn-xs" type="button" style="margin:0;display: inline-block;">上传</button> </td>'):void 0:'<td tableId="'+t+'">'+(l[t]?l[t]:"")+"</td>"},TABLE_ALL=function(e){return result=' <table class="layui-table" style="width:'+e.width+'">'+TABLE_HEAD(e.cols)+TABLE_BODY(e.data,e.cols,e.elem.replace("#",""))+"</table>"},Class=function(e){var a=this;a.config=e,dataTable.cache[e.elem.replace("#","")]=e.data,a.render(e.elem,TABLE_ALL(e)),a.add(e),a.deleteAndEdit(e.elem)},Class.prototype.render=function(e,t){var d=this;a(e).append(t),dataTable.Render.date[e.replace("#","")]&&d.dateRender(e.replace("#",""),!1)},Class.prototype.dateRender=function(e,a){if(a===!1)for(var d in dataTable.Render.date[e])for(var l=0;l<dataTable.Render.date[e][d].data.length;l++)t.render({elem:"#"+dataTable.Render.date[e][d].data[l],trigger:"click"});else if(a)for(var d in dataTable.Render.date[e])t.render({elem:"#"+dataTable.Render.date[e][d].data[0].split("-")[0]+"-"+dataTable.Render.date[e][d].index,trigger:"click"})},Class.prototype.uploadRender=function(e,a){if(a)d.render({elem:"#"+dataTable.Render.upload[e][0].split("-")[0]+"-"+dataTable.Render.date[e+"-index"],url:"${ctx}/laboratory/minioFileController/uploadFileAndAdd",data:{bucketName:"zsjcz-image"},uploaddisplay:{serverUrl:"${ctx}/laboratory/minioFileController/getObject",idCallback:function(e){},urlCallback:function(e){}}});else for(var t=0;t<dataTable.Render.upload[e].length;t++)d.render({elem:"#"+dataTable.Render.upload[e][t],url:"${ctx}/laboratory/minioFileController/uploadFileAndAdd",data:{bucketName:"zsjcz-image"},uploaddisplay:{serverUrl:"${ctx}/laboratory/minioFileController/getObject",idCallback:function(e){},urlCallback:function(e){}}})},Class.prototype.add=function(e){var t=this;e.add&&a(e.add).bind("click",function(){var d=TABLE_ONE(e.data,e.cols,e.elem.replace("#",""));a(e.elem+" table").append(d),dataTable.Render.date[e.elem.replace("#","")]&&t.dateRender(e.elem.replace("#",""),!0),dataTable.Render.upload[e.elem.replace("#","")+"-index"]&&t.uploadRender(e.elem.replace("#",""),!0),dataTable.cache[e.elem.replace("#","")][dataTable.index[[e.elem.replace("#","")]]]={}})},Class.prototype.deleteAndEdit=function(e){a(e).on("click",'button[tableId="delete"]',function(){var t=a(this).parent().parent().attr("id").split("-")[1];dataTable.cache[e.replace("#","")].splice(t,1),console.log(dataTable.cache[e.replace("#","")]),a(this).parent().parent().remove(),dataTable.index[e.replace("#","")]=dataTable.index[e.replace("#","")]-1,a(e+" table tbody tr[id]").each(function(t){a(this).attr("id",e.replace("#","")+"-"+t)})}),a(e).on("blur","td",function(t){if("button"!==t.target.nodeName.toLowerCase()&&"input"!==t.target.nodeName.toLowerCase()){var d=a(this).parent().attr("id").split("-")[1],l=a(this).attr("tableId");dataTable.cache[e.replace("#","")][d][l]=a(this).text(),console.log(dataTable.cache[e.replace("#","")])}if("input"===t.target.nodeName.toLowerCase()){var d=a(this).parent().attr("id").split("-")[1],l=a(this).attr("tableId"),n=a(this).children(":first").attr("id");setTimeout(function(){lay("#"+n).each(function(a,t){dataTable.cache[e.replace("#","")][d][l]=t.value,console.log(dataTable.cache[e.replace("#","")])})},100)}})},dataTable.render=function(e){var a=new Class(e);return a},e("dataTable",dataTable)});