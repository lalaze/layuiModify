/** layui-v2.5.5 MIT License By https://www.layui.com */
 ;layui.define(["layer","laytpl"],function(e){"use strict";var i=layui.$,a=layui.layer,t=layui.laytpl,n=layui.hint(),l=layui.device(),o={config:{},set:function(e){var a=this;return a.config=i.extend({},a.config,e),a},on:function(e,i){return layui.onevent.call(this,s,e,i)}},r=function(){var e=this;return{upload:function(i){e.upload.call(e,i)},reload:function(i){e.reload.call(e,i)},config:e.config}},s="upload",c="layui-upload-file",p="layui-upload-form",u="layui-upload-iframe",d="layui-upload-choose",f=function(e){var a=this;a.config=i.extend({},a.config,o.config,e),a.render();var t=!(!e.uploaddisplay.fileId||!e.uploaddisplay.serverUrl);e.uploaddisplay.fileId||a.idNull(),e.uploaddisplay.fileId&&t&&a.displayCall()};f.prototype.config={accept:"images",exts:"",auto:!0,bindAction:"",url:"",field:"file",acceptMime:"",method:"post",data:{},drag:!0,size:0,number:0,multiple:!1,uploaddisplay:{serverUrl:"",fileId:"",deleteBtnId:""}},f.prototype.render=function(e){var a=this,e=a.config;e.elem=i(e.elem),e.bindAction=i(e.bindAction),a.file(),a.events()},f.prototype.displayCall=function(e){var a=this,e=a.config;e.elem=i(e.elem);var t=e.uploaddisplay.fileId.split(",");t instanceof Array?t.forEach(function(i){a.ajaxUrl(e,i)}):a.ajaxUrl(e,t)},f.prototype.idNull=function(e){var a=this,e=a.config;e.elem=i(e.elem),e.elem.parent().find("span").each(function(){var e=i(this);e.removeClass("layui-anim-fadein"),e.addClass("layui-anim-fadeout"),e.on("animationend",function(){e.css({height:"0",margin:"0"})}),e.on("transitionend",function(){e.remove()})})},f.prototype.ajaxUrl=function(e,n){var l=this,e=l.config;e.elem=i(e.elem),n=n?n:e.uploaddisplay.fileId,i.ajax({url:e.uploaddisplay.serverUrl+"?fileId="+n,type:"get",contentType:!1,processData:!1,headers:e.headers||{},success:function(i){if(0===i.code)if(e.multiple!==!0){var o=String(i.data.name);o=o.substring(o.length-4,o.length+1).replace(".",""),/(gif|png|jpg|jpeg|webp|svg|psd|bmp|tif)$/i.test(o)&&(o="img");var r={icon:o,url:i.data.url,name:String(i.data.name)},s='<span name="fileNameEchoDisplay" class="upload-display layui-anim-fadein"  id="fileNameEchoDisplay'+n+'"><svg class="icon" aria-hidden="true" style="font-size:16px;"><use xlink:href="#icon-{{=  d.icon}}"></use></svg><a href="{{= d.url}}" target="_blank" style="font-size:14px;">{{=  d.name}}</a></span>';t(s).render(r,function(a){e.elem.parent().prepend(a),e.elem.parent().find(".layui-btn").css("visibility","hidden"),e.elem.parent().find(".layui-btn-primary").css("visibility","visible"),e.uploaddisplay.deleteBtnId&&l.deleteEchoDisplay(e,n),"function"==typeof e.uploaddisplay.urlCallback&&e.uploaddisplay.urlCallback(i,e.elem)})}else{var o=String(i.data.name);o=o.substring(o.length-4,o.length+1).replace(".",""),/(gif|png|jpg|jpeg|webp|svg|psd|bmp|tif)$/i.test(o)&&(o="img");var r={icon:o,url:i.data.url,name:String(i.data.name)},s='<div class="layui-input result" style="width:calc(100% - 64px);color:#7575a1;padding-left:10px;overflow:hidden;display:flex;align-items:center;position:relative;"><span name="fileNameEchoDisplay" class="upload-display layui-anim-fadein"  id="fileNameEchoDisplay'+n+'"><svg class="icon" aria-hidden="true" style="font-size:16px;"><use xlink:href="#icon-{{=  d.icon}}"></use></svg><a href="{{= d.url}}" target="_blank" style="font-size:14px;">{{=  d.name}}</a><svg class="icon clickDel" aria-hidden="true" style="margin-left:0.5rem;font-size:16px;color:red;cursor:pointer;"><use xlink:href="#icon-guanbi"></use></svg></span></div>';t(s).render(r,function(a){e.elem.parent().addClass("layui-upload-multiple"),e.elem.parent().prepend(a),e.uploaddisplay.deleteBtnId&&l.deleteEchoDisplay(e,n),"function"==typeof e.uploaddisplay.urlCallback&&e.uploaddisplay.urlCallback(i,e.elem)})}else a.msg(i.msg,{icon:2})},error:function(){l.msg("请求上传接口出现异常"),error(index)}})},f.prototype.deleteEchoDisplay=function(e,a){var t=this,e=t.config;e.elem=i(e.elem),i(e.uploaddisplay.deleteBtnId).unbind("click"),e.multiple===!0?i(".clickDel").on("click",function(){i(this).parent().parent().remove(),"function"==typeof e.uploaddisplay.deleteEchoDisplay&&e.uploaddisplay.deleteEchoDisplay(function(e){})}):i(e.uploaddisplay.deleteBtnId).on("click",function(){e.elem.parent().find(".layui-btn").css("visibility","visible"),e.elem.parent().find(".layui-btn-primary").css("visibility","hidden");var t=i("#fileNameEchoDisplay"+a);t.removeClass("layui-anim-fadein"),t.addClass("layui-anim-fadeout"),t.on("animationend",function(){t.css({height:"0",margin:"0"})}),t.on("transitionend",function(){t.remove()}),"function"==typeof e.uploaddisplay.deleteEchoDisplay&&e.uploaddisplay.deleteEchoDisplay(function(e){})})},f.prototype.file=function(){var e=this,a=e.config,t=e.elemFile=i(['<input class="'+c+'" type="file" accept="'+a.acceptMime+'" name="'+a.field+'"',a.multiple?" multiple":"",">"].join("")),n=a.elem.next();(n.hasClass(c)||n.hasClass(p))&&n.remove(),l.ie&&l.ie<10&&a.elem.wrap('<div class="layui-upload-wrap"></div>'),e.isFile()?(e.elemFile=a.elem,a.field=a.elem[0].name):a.elem.after(t),1==a.multiple||(a.elem.after('<div class="layui-input result" style="padding-left:0;color:#7575a1;overflow:hidden;display:flex;align-items:center;position:relative;"></div>'),a.uploaddisplay.deleteBtnId&&a.elem.next().append(i(a.uploaddisplay.deleteBtnId)),a.elem.next().append(a.elem)),l.ie&&l.ie<10&&e.initIE()},f.prototype.initIE=function(){var e=this,a=e.config,t=i('<iframe id="'+u+'" class="'+u+'" name="'+u+'" frameborder="0"></iframe>'),n=i(['<form target="'+u+'" class="'+p+'" method="post" key="set-mine" enctype="multipart/form-data" action="'+a.url+'">',"</form>"].join(""));i("#"+u)[0]||i("body").append(t),a.elem.next().hasClass(p)||(e.elemFile.wrap(n),a.elem.next("."+p).append(function(){var e=[];return layui.each(a.data,function(i,a){a="function"==typeof a?a():a,e.push('<input type="hidden" name="'+i+'" value="'+a+'">')}),e.join("")}()))},f.prototype.msg=function(e){return a.msg(e,{icon:2,shift:6})},f.prototype.isFile=function(){var e=this.config.elem[0];if(e)return"input"===e.tagName.toLocaleLowerCase()&&"file"===e.type},f.prototype.preview=function(e){var i=this;window.FileReader&&layui.each(i.chooseFiles,function(i,a){var t=new FileReader;t.readAsDataURL(a),t.onload=function(){e&&e(i,a,this.result)}})},f.prototype.upload=function(e,t){var n,o=this,r=o.config,s=o.elemFile[0],c=function(){var t=0,n=0,l=e||o.files||o.chooseFiles||s.files,c=function(){r.multiple&&t+n===o.fileLength&&"function"==typeof r.allDone&&r.allDone({total:o.fileLength,successful:t,aborted:n})};layui.each(l,function(e,l){var s=new FormData;s.append(r.field,l),layui.each(r.data,function(e,i){i="function"==typeof i?i():i,s.append(e,i)}),i.ajax({url:r.url,type:"post",data:s,contentType:!1,processData:!1,dataType:"json",headers:r.headers||{},success:function(i){0==i.code?(t++,m(e,i),r.uploaddisplay.serverUrl&&y(e,i),c()):a.msg(i.msg,{icon:2})},error:function(){n++,o.msg("请求上传接口出现异常"),g(e),c()},xhr:function(){var e=new XMLHttpRequest;return e.upload.addEventListener("progress",function(e){if(e.lengthComputable){var i=Math.floor(e.loaded/e.total*100);"function"==typeof r.progress&&r.progress(i,e)}}),e}})})},p=function(){var e=i("#"+u);o.elemFile.parent().submit(),clearInterval(f.timer),f.timer=setInterval(function(){var i,a=e.contents().find("body");try{i=a.text()}catch(t){o.msg("获取上传后的响应信息出现异常"),clearInterval(f.timer),g()}i&&(clearInterval(f.timer),a.html(""),m(0,i))},30)},m=function(e,i){if(o.elemFile.next("."+d).remove(),s.value="","object"!=typeof i)try{i=JSON.parse(i)}catch(a){return i={},o.msg("请对上传接口返回有效JSON")}"function"==typeof r.done&&r.done(i,e||0,function(e){o.upload(e)})},y=function(e,i){if(o.elemFile.next("."+d).remove(),s.value="","object"!=typeof i)try{i=JSON.parse(i)}catch(a){return i={},o.msg("请对上传接口返回有效JSON")}0===i.code&&(o.ajaxUrl(r,i.data),"function"==typeof r.uploaddisplay.idCallback&&r.uploaddisplay.idCallback(i,o.config.elem,function(e){}))},g=function(e){r.auto&&(s.value=""),"function"==typeof r.error&&r.error(e||0,function(e){o.upload(e)})},v=r.exts,h=function(){var i=[];return layui.each(e||o.chooseFiles,function(e,a){i.push(a.name)}),i}(),b={preview:function(e){o.preview(e)},upload:function(e,i){var a={};a[e]=i,o.upload(a)},pushFile:function(){return o.files=o.files||{},layui.each(o.chooseFiles,function(e,i){o.files[e]=i}),o.files},resetFile:function(e,i,a){var t=new File([i],a);o.files=o.files||{},o.files[e]=t}},x=function(){if("choose"!==t&&!r.auto||(r.choose&&r.choose(b),"choose"!==t))return r.before&&r.before(b),l.ie?l.ie>9?c():p():void c()};if(h=0===h.length?s.value.match(/[^\/\\]+\..+/g)||[]||"":h,0!==h.length){switch(r.accept){case"file":if(v&&!RegExp("\\w\\.("+v+")$","i").test(escape(h)))return o.msg("选择的文件中包含不支持的格式"),s.value="";break;case"video":if(!RegExp("\\w\\.("+(v||"avi|mp4|wma|rmvb|rm|flash|3gp|flv")+")$","i").test(escape(h)))return o.msg("选择的视频中包含不支持的格式"),s.value="";break;case"audio":if(!RegExp("\\w\\.("+(v||"mp3|wav|mid")+")$","i").test(escape(h)))return o.msg("选择的音频中包含不支持的格式"),s.value="";break;case"pdf":if(!RegExp("\\w\\.("+(v||"pdf")+")$","i").test(escape(h)))return o.msg("选择的文件不为pdf"),s.value="";break;default:if(layui.each(h,function(e,i){RegExp("\\w\\.("+(v||"jpg|png|gif|bmp|jpeg$")+")","i").test(escape(i))||(n=!0)}),n)return o.msg("选择的图片中包含不支持的格式"),s.value=""}switch(r.accept){case"file":v&&!RegExp("\\w\\.("+v+")$","i").test(escape(h))||(r.data.scourceType=0);break;case"video":RegExp("\\w\\.("+(v||"avi|mp4|wma|rmvb|rm|flash|3gp|flv")+")$","i").test(escape(h))&&(r.data.scourceType=2);break;case"audio":RegExp("\\w\\.("+(v||"mp3|wav|mid")+")$","i").test(escape(h))&&(r.data.scourceType=2);break;case"pdf":RegExp("\\w\\.("+(v||"pdf")+")$","i").test(escape(h))&&(r.data.scourceType=3);break;default:layui.each(h,function(e,i){RegExp("\\w\\.("+(v||"jpg|png|gif|bmp|jpeg$")+")","i").test(escape(i))&&(n=!0)}),n&&(r.data.scourceType=1)}if(o.fileLength=function(){var i=0,a=e||o.files||o.chooseFiles||s.files;return layui.each(a,function(){i++}),i}(),r.number&&o.fileLength>r.number)return o.msg("同时最多只能上传的数量为："+r.number);if(r.size>0&&!(l.ie&&l.ie<10)){var w;if(layui.each(o.chooseFiles,function(e,i){if(i.size>1024*r.size){var a=r.size/1024;a=a>=1?a.toFixed(2)+"MB":r.size+"KB",s.value="",w=a}}),w)return o.msg("文件不能超过"+w)}x()}},f.prototype.reload=function(e){e=e||{},delete e.elem,delete e.bindAction;var a=this,e=a.config=i.extend({},a.config,o.config,e),t=e.elem.next();t.attr({name:e.name,accept:e.acceptMime,multiple:e.multiple})},f.prototype.events=function(){var e=this,a=e.config,t=function(i){e.chooseFiles={},layui.each(i,function(i,a){var t=(new Date).getTime();e.chooseFiles[t+"-"+i]=a})},o=function(i,t){var n=e.elemFile,l=i.length>1?i.length+"个文件":(i[0]||{}).name||n[0].value.match(/[^\/\\]+\..+/g)||[]||"";n.next().hasClass(d)&&n.next().remove(),e.upload(null,"choose"),e.isFile()||a.choose||n.after('<span class="layui-inline '+d+'">'+l+"</span>")};a.elem.off("upload.start").on("upload.start",function(){var t=i(this),l=t.attr("lay-data");if(l)try{l=new Function("return "+l)(),e.config=i.extend({},a,l)}catch(o){n.error("Upload element property lay-data configuration item has a syntax error: "+l)}e.config.item=t,e.elemFile[0].click()}),l.ie&&l.ie<10||a.elem.off("upload.over").on("upload.over",function(){var e=i(this);e.attr("lay-over","")}).off("upload.leave").on("upload.leave",function(){var e=i(this);e.removeAttr("lay-over")}).off("upload.drop").on("upload.drop",function(n,l){var r=i(this),s=l.originalEvent.dataTransfer.files||[];r.removeAttr("lay-over"),t(s),a.auto?e.upload(s):o(s)}),e.elemFile.off("upload.change").on("upload.change",function(){var i=this.files||[];t(i),a.auto?e.upload():o(i)}),a.bindAction.off("upload.action").on("upload.action",function(){e.upload()}),a.elem.data("haveEvents")||(e.elemFile.on("change",function(){i(this).trigger("upload.change")}),a.elem.on("click",function(){e.isFile()||i(this).trigger("upload.start")}),a.drag&&a.elem.on("dragover",function(e){e.preventDefault(),i(this).trigger("upload.over")}).on("dragleave",function(e){i(this).trigger("upload.leave")}).on("drop",function(e){e.preventDefault(),i(this).trigger("upload.drop",e)}),a.bindAction.on("click",function(){i(this).trigger("upload.action")}),a.elem.data("haveEvents",!0))},o.render=function(e){var i=new f(e);return r.call(i)},e(s,o)});